"0","cc_graph_filtered<-cc_graph[ConfirmedCases<10^9 & `Country/Region` %in% select_countries &"
"0","                              case_date<Sys.Date()+10]"
"0","country_labels<-cc_graph_filtered[`Country/Region` %in% select_countries ,"
"0","                              .(intercept_date=max(case_date)),"
"0","                              by=`Country/Region`] %>% "
"0"," merge(cc_graph_filtered[,.(`Country/Region`,case_date,ConfirmedCases)],"
"0","                     by.x=c(""Country/Region"",""intercept_date""),"
"0","                     by.y=c(""Country/Region"",""case_date""),"
"0","       all.x=TRUE,all.y=FALSE)"
"0","country_labels[,CasesGroup:=round(log(ConfirmedCases,10),1)]"
"0","country_labels_grouped<- country_labels[,"
"0","                                        .(Countries=paste0(`Country/Region`, collapse="", ""),"
"0","                                          GroupedCC=mean(ConfirmedCases),"
"0","                                          `Country/Region` = .SD[`Country/Region`][[1]]"
"0","                                          )"
"0","                                        ,by=.(CasesGroup,intercept_date)] %>% .[GroupedCC>2]"
"0","#x_breaks  <- seq(min(new_cases$case_date),max(new_cases$case_date),7)"
"0","country_labels_grouped$CaseDataType<-""Actual"""
"0","#cut off values greater than 1 billion as implausible"
"0","#numbers below that are implausible too but we have to do this to avoid a ggplot error bug"
"0","myplot<-ggplot(cc_graph_filtered,"
"0","      aes(x=as.Date(case_date),y=ConfirmedCases,linetype=CaseDataType,"
"0","          group=interaction(`Country/Region`,CaseDataType)))+"
"0"," geom_line(size=1,alpha=0.3)+"
"0","  theme_classic()+"
"0"," #geom_point(alpha=0.5)+"
"0"," scale_x_date(#limits = c(min(cc_graph$case_date),max(Sys.Date()+7)),#breaks=x_breaks,"
"0","   date_breaks = ""7 days"","
"0","                    minor_breaks=NULL,date_labels=""%b %d"")+"
"0"," coord_cartesian(xlim=c(min(cc_graph$case_date),max(cc_graph$case_date)),"
"0","                 ylim=c(20,max(cc_graph_filtered$ConfirmedCases)))+"
"0"," scale_y_continuous(trans = ""log10"","
"0","                    breaks = rep(c(2,5,10),8)*rep(10^seq(1,8-1,1),each=3),"
"0","                    minor_breaks=NULL,"
"0","                    labels = scales::comma)+#,"
"0","                    #sec.axis = dup_axis())+"
"0"," #geom_vline(xintercept = 0,linetype=""dashed"")+"
"0"," #geom_hline(yintercept = threshold,,linetype=""dashed"")+"
"0"," labs(title=paste0(""Confirmed cases and predictions by day and country""),"
"0","      x=paste0(""Date""),"
"0","      y=""Confirmed cases and predictions"","
"0","      color=""Date Country Reached Threshold"","
"0","      caption=""Source: John Hopkins Dataset"")+"
"0"," theme(legend.position = ""none"")+"
"0"," geom_text(data=country_labels_grouped[`Country/Region` %in% select_countries],"
"0","           aes(x=intercept_date,y=GroupedCC,label=Countries),"
"0","           hjust=0,size=2,fontface=""bold"")"
"2","longer object length is not a multiple of shorter object length"
"0","#htmlwidgets::saveWidget(as_widget(ggplotly(myplot)),""new_cases_prediction.html"",selfcontained=FALSE)"
"0","  "
"0","myplot"
